---
title: Deploy a smart contract with SmartPy
authors: 'John Joubert, Sasha Aldrick, Tim McMackin'
last_update:
  date: 26 February 2024
---

This tutorial covers writing and deploying a simple smart contract with the SmartPy programming language.
SmartPy has syntax similar to Python, but you don't need any experience with Python or SmartPy to do this tutorial.

SmartPy is a high-level programming language that you can use to write smart contracts for the Tezos blockchain.
It abstracts away the complexity of using Michelson (the smart contract language directly available on-chain) and provides a syntax that makes it easier to write smart contracts on Tezos.

In this tutorial, you will learn how to:

- Create a wallet
- Get tokens from a faucet
- Code a contract in SmartPy, including:
  - Creating a contract in the online IDE
  - Defining the storage for the contract
  - Defining entrypoints in the contract
  - Writing code to run when the entrypoints are called
- Deploy (or originate) the contract to Tezos and set its starting storage value
- Look up the current state of the contract
- Call the contract

## What is a smart contract?

A smart contract is a computer program that is stored on a blockchain and runs on a blockchain.
Because the blockchain is spread across many computer nodes, you don't have to think about where to host the program or worry whether a computer will run it or not.
Responsibility for running the contract is distributed across all of the nodes in the Tezos system, so when you deploy a smart contract, you can be confident that it will be available and unmodified when someone wants to run it.

A smart contract has these parts:

- It has persistent storage, data that the contract can read and write
- It has one or more entrypoints, which are a kind of function that clients can call, like endpoints in an API or functions or methods in many programming languages
- It has a Tezos account and can store tez (technically, the contract is itself a type of Tezos account, but you can think of it as a program with a Tezos account)

## Tutorial contract

The contract that you deploy in this tutorial stores a string value.
It provides entrypoints that clients can call to change the value of that string:

- The `replace` entrypoint accepts a new string as a parameter and stores that string, replacing the existing string.
- The `append` entrypoint accepts a new string as a parameter and appends it to the existing string.

After you deploy the contract, you or any other user can call it from various sources, including web applications, other contracts, and the Octez command-line client.

## Setting up a development environment

While SmartPy has an [online IDE](https://smartpy.io/ide), many developers prefer to set up SmartPy locally so they can code their smart contracts in the way that they normally work.

Follow these steps to set up your development environment:

1. Install [Python](https://www.python.org/).

1. Install SmartPy by running this command:

   ```bash
   pip install https://smartpy.io/static/tezos_smartpy-0.19.1-py3-none-any.whl
   ```

1. Verify that SmartPy is installed by running these commands to download and compile a smart contract:

   ```bash
   wget smartpy.io/templates/welcome.py
   python welcome.py
   ```

   If SmartPy is installed correctly, the `python` command creates a folder named `welcome/` with compiled code.

1. Install the Octez client, which sends transactions to Tezos.
(The Octez suite includes many programs, but for now all you need is the Octez client.)

   - For Ubuntu, Windows WSL, and Linux distributions that use `apt`, run these commands:

   ```bash
   REPO="ppa:serokell/tezos"
   sudo add-apt-repository -y $REPO && sudo apt-get update
   sudo apt-get install -y tezos-client
   ```

   - For Fedora and Linux distributions that use Copr, run these commands:

   ```bash
   REPO="@Serokell/Tezos"
   dnf copr enable -y $REPO && dnf update -y
   dnf install -y tezos-client
   ```

   - For MacOS, use `brew`:

   ```bash
   brew tap serokell/tezos-packaging-stable https://github.com/serokell/tezos-packaging-stable.git
   brew install tezos-client
   ```

   - For other methods, see https://tezos.gitlab.io/introduction/howtoget.html.

1. Verify that you have version 19 of the Octez client by running `octez-client --version` and verifying that the version is at least 19.0.

1. Set the Octez client to use the Ghostnet test network:

   - If you just installed Octez for the first time, run this command:

      ```bash
      octez-client -E https://rpc.ghostnet.teztnets.com config init
      ```

   - If you already had Octez installed, run this command:

      ```bash
      octez-client -E https://rpc.ghostnet.teztnets.com config update
      ```

1. Verify that you are using Ghostnet by running `octez-client config show` and verifying that the `endpoint` field shows `https://rpc.ghostnet.teztnets.com`, as in this example:

   ```
   { "base_dir": "/Users/me/.tezos-client",
     "endpoint": "https://rpc.ghostnet.teztnets.com", "web_port": 8080,
     "confirmations": 0 }
   ```

1. Optional: Disable the warning message about using a test network by running this command:

   ```bash
   export TEZOS_CLIENT_UNSAFE_DISABLE_DISCLAIMER=y
   ```

1. In the Octez client, create a wallet by running this command:

   ```bash
   octez-client gen keys local_wallet
   ```

1. Get your account's address by running this command:

   ```bash
   octez-client show address local_wallet
   ```

   The Octez client prints the address of the new wallet in the `hash` field.
   The wallet address begins with `tz1`, `tz2`, or `tz3`, as in this example:

   ```bash
   Hash: tz1dW9Mk...........H67L
   Public Key: edp.............................bjbeDj
   ```

    You need the wallet address to send funds to the wallet, to deploy the contract, and to send transactions to the contract.

1. Copy your account's address, which starts with `tz1`.

1. In a web browser, go to the Ghostnet faucet at https://faucet.ghostnet.teztnets.com/.

1. Paste your address into the "Fund any address" field and send some tez to your account.
20 tez is enough to start with, and you can always return to the faucet for more.

1. Verify that your account has tez by running this command:

   ```bash
   octez-client get balance for local_wallet
   ```

Now you have an account and funds that you can use to work with Tezos.

## Creating the contract

Follow these steps to create the code for the contract:

1. In any text editor, create a file named `store_greeting.py`.

1. Add this line of code to import SmartPy:

   ```python
   import smartpy as sp
   ```

1. Add this code that creates the entrypoints:

   ```python
   @sp.module
   def main():
       class StoreGreeting(sp.Contract):
           def __init__(self, greeting): # Note the indentation
               # Initialize the storage with a string passed at deployment time
               # Cast the greeting parameter to a string
               sp.cast(greeting, sp.string)
               self.data.greeting = greeting

           @sp.entrypoint # Note the indentation
           def replace(self, params):
               self.data.greeting = params.text

           @sp.entrypoint # Note the indentation
           def append(self, params):
               self.data.greeting += params.text
   ```

   Indentation is significant in Python, so make sure that your indentation matches this code.

   The first two lines create a SmartPy module, which indicates that the code is SmartPy instead of ordinary Python.

   Then the code creates a class named StoreGreeting, which represents the smart contract.
   The contract has an `__init__` function, which runs when the contract is deployed.
   In this case, the function sets the initial value of the storage to a parameter that you pass when you deploy the contract.
   This storage value is a string, but the storage can be another primitive type such as an integer or timestamp, or a complex data type that contains multiple values.

1. Add this code that creates the tests:

   ```python
   @sp.add_test(name = "StoreGreeting")
   def test():
     scenario = sp.test_scenario(main)
     scenario.h1("StoreGreeting")

     contract = main.StoreGreeting("Hello")
     scenario += contract

     scenario.verify(contract.data.greeting == "Hello")

     contract.replace(text = "Hi")
     contract.append(text = ", there!")
     scenario.verify(contract.data.greeting == "Hi, there!")
   ```

   These tests run automatically on compilation to verify that the replace and append endpoints work.

The complete contract looks like this:

```python
import smartpy as sp

@sp.module
def main():
    class StoreGreeting(sp.Contract):
        def __init__(self, greeting): # Note the indentation
            # Initialize the storage with a string passed at deployment time
            # Cast the greeting parameter to a string
            sp.cast(greeting, sp.string)
            self.data.greeting = greeting

        @sp.entrypoint # Note the indentation
        def replace(self, params):
            self.data.greeting = params.text

        @sp.entrypoint # Note the indentation
        def append(self, params):
            self.data.greeting += params.text

# Automated tests that run on simulation
@sp.add_test()
def test():
    # Initialize the test scenario
    scenario = sp.test_scenario("Test scenario", main)
    scenario.h1("StoreGreeting")

    # Initialize the contract and pass the starting value
    contract = main.StoreGreeting("Hello")
    scenario += contract

    # Verify that the value in storage was set correctly
    scenario.verify(contract.data.greeting == "Hello")

    # Test the entrypoints and check the new storage value
    contract.replace(text = "Hi")
    contract.append(text = ", there!")
    scenario.verify(contract.data.greeting == "Hi, there!")
```

## Testing and compiling the contract

Before you can deploy the contract to Tezos, you must compile it to Michelson, the base language of Tezos contracts.
The compilation process automatically runs the tests in the `store_greeting.py` file.

1. Run this command to compile the contract:

   ```bash
   python store_greeting.py
   ```

If the compilation succeeds, no messages are shown in the terminal and SmartPy creates a compiled smart contract in the `Test_scenario/` folder.
If you see error messages, verify that your contract code matches the code in the previous section.

The output includes JSON Michelson in `.json` files and [Micheline Michelson](https://tezos.gitlab.io/shell/micheline.html) in `.tz` files.
The most important file is named `step_002_cont_0_contract.tz`.
This is the Michelson file that you will use to deploy the contract to the testnet.

## Deploying (originating) to the testnet

Deploying a contract to the network is called "originating."
Originating the contract requires a small amount of Tezos tokens as a fee.

1. Under the origination step, click **Show Michelson**.

   <img src="/img/tutorials/smartpy-ide-origination-annotated.png" alt="The originated contract, with the Show Michelson button highlighted" style={{width: 300}} />

   The IDE shows the compiled Michelson code of the contract, which is the language that smart contracts use on Tezos.

1. Below the Michelson code, click **Deploy Contract**.

1. In the new window, under "Node and Network," select the Ghostnet testnet and accept the default RPC node, as in this picture:

   <img src="/img/tutorials/smartpy-ide-network.png" alt="Selecting the Ghostnet network and default RPC node" style={{width: 600}} />

1. Under "Wallet," click **Select Account**.

1. In the pop-up window, connect your wallet.
For Temple wallets, use the Temple tab, and for most other wallets, use the Beacon tab.

1. When your wallet is connected, click **Validate**.

   The Origination page shows your wallet information:

   <img src="/img/tutorials/smartpy-ide-connected-wallet.png" alt="The successful connection to your wallet on the origination page" style={{width: 500}} />

1. At the bottom of the page, click **Deploy Contract**.

1. In the pop-up window, click **Accept**.

1. Approve the transaction in your wallet app.

   The "Origination Result" section shows information about the deployed contract, including its address:

   <img src="/img/tutorials/smartpy-ide-originated-contract.png" alt="Information about the originated contract" style={{width: 500}} />

1. Under the contract address, click **Save Contract**.

1. In the popup window, give the contract a name and click **Add Contract**.
Saving the contract address like this is important because the address is not shown again.

1. Open the contract in the block explorer Better Call Dev:

   1. In a new browser tab, go to https://better-call.dev/.

   1. Paste the contract address in the search box and press Enter.

   The block explorer shows information about the contract, including recent transactions and the current state of its storage.

   <img src="/img/tutorials/bcd-originated-contract.png" alt="The block explorer, showing information about the contract" style={{width: 500}} />

1. Try calling one of the entrypoints:

   1. Go to the **Storage** tab and check the current state of the storage.
   If you just originated  the contract, the storage is "Hello" because that's the value set in the smart contract code.

   1. Go to the **Interact** tab.
   This tab shows the entrypoints in the contract and lets you use them.

   1. For the `append` entrypoint, in the **Parameters** section, put some text in the field, as shown in this image:

      <img src="/img/tutorials/bcd-interact-parameters.png" alt="Putting in a value for an entrypoint parameter" style={{width: 500}} />

   1. Click **Execute** and then click **Wallet**.

   1. Select your wallet and connect it to the application.

   1. Confirm the transaction in your wallet.

   1. Wait for a success message that says "The transaction has successfully been broadcasted to the network."

   1. Go back to the **Storage** tab and see that the text that you put in the parameter has been added to the contract storage, as in this picture:

      <img src="/img/tutorials/bcd-updated-storage.png" alt="Updated storage value" style={{width: 500}} />

## Summary

Now the contract is running on the Tezos blockchain.
You or any other user can call it from any source that can send transactions to Tezos, including Octez, dApps, and other contracts.

If you want to continue working with this contract, try creating a dApp to call it from a web application, similar to the dApp that you create in the tutorial [Build a simple web application](../build-your-first-app/).
You can also try adding your own entrypoints and originating a new contract, but you cannot update the existing contract after it is deployed.
